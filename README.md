My first attempt at making alterations to this code
